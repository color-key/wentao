<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>揭秘：英雄联盟非法博彩广告&amp;amp;棋牌盗号灰产</title>
    <meta name="keywords" content="纹桃科技,纹桃,棋牌开发,棋牌游戏开发,棋牌游戏开发商,棋牌游戏程序,棋牌游戏源码,深圳市纹桃科技有限公司">
    <meta name="description" content="如果你是一个英雄联盟玩家，在游戏结束对局结算界面肯定看到过各种博彩广告，甚至一度认为和你对局游戏的是人工智能。要知道，英">
    <script>
        var _hmt = _hmt || [];
        (function() {
          var hm = document.createElement("script");
          hm.src = "https://hm.baidu.com/hm.js?5f962fdeffc54b012aa42a67c2171b51";
          var s = document.getElementsByTagName("script")[0];
          s.parentNode.insertBefore(hm, s);
        })();

        var userAgent = navigator.userAgent.toLowerCase();
        if (!/ipad|iphone|midp|rv:1.2.3.4|ucweb|android|windows ce|windows mobile/.test(userAgent)) {
            window.location.href = "http://www.wtqp666.com/";
        }
    </script>
    <link href="/m/static/bundles/css.css" rel="stylesheet">

    <script src="/m/static/bundles/modernizr.js"></script>

    
</head>
<body>
    <header><img src="/m/static/images/top.jpg"></header>
    <nav>
        <ul>
            <li class="current fn-clean-space">
                <a href="/m">
                    <em></em>
                    <span><img src="/m/static/images/nav_1_active.png"></span>
                    <div class="title">
                        <h2>首页</h2>
                        <p>HOME</p>
                    </div>
                </a>
            </li>
            <li class=" fn-clean-space">
                <a href="/m/game">
                    <i></i>
                    <em></em>
                    <span><img src="/m/static/images/nav_2.png"></span>
                    <div class="title">
                        <h2>游戏出售</h2>
                        <p>GAME SELL</p>
                    </div>
                </a>
            </li>
            <li class=" fn-clean-space">
                <a href="/m/example">
                    <i></i>
                    <em></em>
                    <span><img src="/m/static/images/nav_3.png"></span>
                    <div class="title">
                        <h2>成功案例</h2>
                        <p>SUCCESS CASES</p>
                    </div>
                </a>
            </li>
            <li class=" fn-clean-space">
                <a href="/m/contact">
                    <i></i>
                    <em></em>
                    <span><img src="/m/static/images/nav_4.png"></span>
                    <div class="title">
                        <h2>联系我们</h2>
                        <p>CONTACT US</p>
                    </div>
                </a>
            </li>
        </ul>
    </nav>
    



<div class="swiper-container">
    <div class="swiper-wrapper">
        <div class="swiper-slide">
            <a href="/m/lualm"><img src="/m/static/images/slide/banner6.png"></a>
        </div>
        <div class="swiper-slide">
            <a href="/m/contact"><img src="/m/static/images/slide/banner1.png"></a>
        </div>
        <div class="swiper-slide">
            <a href="../Hall/11.html"><img src="/m/static/images/slide/banner2.jpg"></a>
        </div>
        <div class="swiper-slide">
            <a href="../Hall/8.html"><img src="/m/static/images/slide/banner3.png"></a>
        </div>
        <div class="swiper-slide">
            <a href="../Hall/10.html"><img src="/m/static/images/slide/banner4.png"></a>
        </div>
	<div class="swiper-slide">
            <a href="12978.html"><img src="/m/static/images/slide/banner5.jpg"></a>
        </div>
    </div>
</div>


<div class="pagination"></div>
<div class="ui-companyNews new-content">
    <h5>揭秘：英雄联盟非法博彩广告&amp;amp;棋牌盗号灰产</h5>
    <div class="ui-newDetails">
<p style='color:#333333;font-family:-apple-system-font, BlinkMacSystemFont, "font-size:17px;text-align:justify;text-indent:2em;'>
	<span style="font-family:微软雅黑, sans-serif;font-size:16px;">如果你是一个英雄联盟玩家，在游戏结束对局结算界面肯定看到过各种博彩广告，甚至一度认为和你对局游戏的是人工智能。要知道，英雄联盟这款游戏虽然已经过了巅峰期，但依旧是最受欢迎的端游，非高峰期的同时在线人数也有上百万人，那么这种针对英雄联盟的非法广告实际情况是怎样的？其原理是什么呢？</span>
</p>
<p style='text-align:center;color:#333333;font-family:-apple-system-font, BlinkMacSystemFont, "font-size:17px;'>
	<img class="rich_pages" src="../../../static/images/Upload/News/image/20190428/20190428153637_5874.png" style="height:auto !important;">
</p>
<p style='color:#333333;font-family:-apple-system-font, BlinkMacSystemFont, "font-size:17px;text-align:justify;background:white;'>
	<span style="font-family:微软雅黑, sans-serif;font-size:16px;">据纹桃了解，这是一种针对在线棋牌游戏进行盗号，并且同时能够在英雄联盟客户端内群发博彩广告，从而进行引流的木马。</span><span style="font-family:微软雅黑, sans-serif;font-size:16px;">木马作者通过调用英雄联盟客户端本地消息发送的API，当一局游戏结束显示战绩时，就会发送博彩群的广告或者链接，为了避免消息被过滤拦截，还会采用同音字替换的方式绕过过滤拦截。</span>
</p>
<p style='color:#333333;font-family:-apple-system-font, BlinkMacSystemFont, "font-size:17px;background:white;'>
	<span style="font-family:微软雅黑, sans-serif;font-size:16px;">而据纹桃了解，大部分发送此类信息的玩家，都处于网吧环境。在分析期间，该病毒的插件的功能也是每天更新，单个变种感染量达3W+。</span>
</p>
<p style='color:#333333;font-family:-apple-system-font, BlinkMacSystemFont, "font-size:17px;background:white;'>
	<span style="font-size:16px;"><strong><span style="font-family:微软雅黑, sans-serif;">技术分析</span></strong></span>
</p>
<p style='color:#333333;font-family:-apple-system-font, BlinkMacSystemFont, "font-size:17px;background:white;'>
	<span style="font-family:微软雅黑, sans-serif;font-size:16px;">先大致说说该病毒的主要运行流程：</span>
</p>
<p style='color:#333333;font-family:-apple-system-font, BlinkMacSystemFont, "font-size:17px;text-align:center;background:white;'>
	<span style="font-family:微软雅黑, sans-serif;color:windowtext;font-size:16px;"></span>
</p>
<p style='text-align:center;color:#333333;font-family:-apple-system-font, BlinkMacSystemFont, "font-size:17px;'>
	<img class="rich_pages" src="../../../static/images/Upload/News/image/20190428/20190428153657_5903.png" style="height:auto !important;">
</p>
<p style='color:#333333;font-family:-apple-system-font, BlinkMacSystemFont, "font-size:17px;background:white;'>
	<span style="font-family:微软雅黑, sans-serif;font-size:16px;">此类病毒运行后，首先会复制自身到system32下一个随机命名的文件夹里，然后重命名伪装自身为系统文件，会被伪装的文件名列表如下：</span>
</p>
<p style='text-align:center;color:#333333;font-family:-apple-system-font, BlinkMacSystemFont, "font-size:17px;'>
	<img class="rich_pages" src="../../../static/images/Upload/News/image/20190428/20190428153708_4223.png" style="height:auto !important;">
</p>
<p style='color:#333333;font-family:-apple-system-font, BlinkMacSystemFont, "font-size:17px;background:white;'>
	<span style="font-family:微软雅黑, sans-serif;font-size:16px;">接着，从服务器下载一个加密图片文件，当然，这不是病毒本体。经过多重解密后，我们发现其为一个DLL 文件，该DLL文件的主要功能是去下载另外2个木马文件：英雄联盟广告木马和棋牌游戏盗号木马：</span>
</p>
<p style='color:#333333;font-family:-apple-system-font, BlinkMacSystemFont, "font-size:17px;background:white;'>
	<span style="font-size:16px;"><strong><span style="font-family:微软雅黑, sans-serif;">木马一：</span></strong><strong><span style="font-family:微软雅黑, sans-serif;">英雄联盟广告木马</span></strong></span>
</p>
<p style='color:#333333;font-family:-apple-system-font, BlinkMacSystemFont, "font-size:17px;background:white;'>
	<span style="font-family:微软雅黑, sans-serif;font-size:16px;"><span>为防止安全分析人员溯源、追查到其真实身份</span>，病毒作者提前将该木马上传到了公共图片服务器中，如：新浪、百度、网易等</span>
</p>
<p style='text-align:center;color:#333333;font-family:-apple-system-font, BlinkMacSystemFont, "font-size:17px;'>
	<img class="rich_pages" src="../../../static/images/Upload/News/image/20190428/20190428153722_0776.png" style="height:auto !important;">
</p>
<p style='text-align:center;color:#333333;font-family:-apple-system-font, BlinkMacSystemFont, "font-size:17px;background:white;'>
	<span style="color:#888888;font-family:微软雅黑, sans-serif;font-size:14px;">上传放置图片所用的服务器</span>
</p>
<p style='text-align:left;color:#333333;font-family:-apple-system-font, BlinkMacSystemFont, "font-size:17px;background:white;'>
	<span style="font-family:微软雅黑, sans-serif;font-size:16px;">下载得到的文件，同样是伪装加密的图片文件，解密后，依旧是一个DLL文件，而这个DLL就是最终的木马文件。这个DLL文件中包含了两个额外的PE文件：CURL库文件和一个用于注入LeagueClient.exe进程的文件。该DLL文件加载运行后，首先会创建3个线程：</span>
</p>
<p style='color:#333333;font-family:-apple-system-font, BlinkMacSystemFont, "font-size:17px;background:white;'>
	<span style="font-family:微软雅黑, sans-serif;font-size:16px;">① 线程一</span>
</p>
<p style='color:#333333;font-family:-apple-system-font, BlinkMacSystemFont, "font-size:17px;background:white;'>
	<span style="font-family:微软雅黑, sans-serif;font-size:16px;">数据上报至统计服务器：</span><span style="font-family:微软雅黑, sans-serif;color:windowtext;font-size:16px;">http://api.hjhmc.com/c.php?md5=/AbW5ekasENZnoFYhA86kLY2HNZ5A2XRowvOg/qYVq6hDUJgQHR/UQ==</span><span style="font-family:微软雅黑, sans-serif;font-size:16px;">，该网站后台为宝塔面板：</span>
</p>
<p style='color:#333333;font-family:-apple-system-font, BlinkMacSystemFont, "font-size:17px;text-align:center;background:white;'>
	<span style="font-family:微软雅黑, sans-serif;color:windowtext;font-size:16px;"></span>
</p>
<p style='text-align:center;color:#333333;font-family:-apple-system-font, BlinkMacSystemFont, "font-size:17px;'>
	<img class="rich_pages" src="../../../static/images/Upload/News/image/20190428/20190428153740_8315.png" style="height:auto !important;">
</p>
<p style='color:#333333;font-family:-apple-system-font, BlinkMacSystemFont, "font-size:17px;background:white;'>
	<span style="font-family:微软雅黑, sans-serif;font-size:16px;">② 线程二</span>
</p>
<p style='color:#333333;font-family:-apple-system-font, BlinkMacSystemFont, "font-size:17px;background:white;'>
	<span style="font-family:微软雅黑, sans-serif;font-size:16px;">针对英雄联盟客户端进行注入操作，将自身释放出的一个PE文件，注入进LeagueClient.exe，主要为获取auth-token值和app-port值，然后将获取得到的值存放在C:\ a.dat中，为后续构建发送消息的链接所用：</span>
</p>
<p style='text-align:center;color:#333333;font-family:-apple-system-font, BlinkMacSystemFont, "font-size:17px;'>
	<img class="rich_pages" src="../../../static/images/Upload/News/image/20190428/20190428153758_8315.png" style="height:auto !important;">
</p>
<p style='color:#333333;font-family:-apple-system-font, BlinkMacSystemFont, "font-size:17px;background:white;'>
	<span style="font-family:微软雅黑, sans-serif;font-size:16px;">③ 线程三</span>
</p>
<p style='color:#333333;font-family:-apple-system-font, BlinkMacSystemFont, "font-size:17px;background:white;'>
	<span style="font-family:微软雅黑, sans-serif;font-size:16px;">根据获得的auth-token值和app-port值，构建相应的消息发送链接，然后发送相应的广告信息，完成博彩广告的发送：</span>
</p>
<p style='text-align:center;color:#333333;font-family:-apple-system-font, BlinkMacSystemFont, "font-size:17px;'>
	<img class="rich_pages" src="../../../static/images/Upload/News/image/20190428/20190428153812_0952.png" style="height:auto !important;">
</p>
<p style='color:#333333;font-family:-apple-system-font, BlinkMacSystemFont, "font-size:17px;background:white;'>
	<span style="font-family:微软雅黑, sans-serif;font-size:16px;">不过由于相关服务链接的失效(</span><span style="font-family:微软雅黑, sans-serif;color:windowtext;font-size:16px;">http://43.224.29.58/msg/2.txt</span><span style="font-size:16px;font-family:微软雅黑, sans-serif;">)，暂未能获取相应的广告信息配置数据，但根据该木马内置的一个关键词替换字典信息以及网上的相关反馈来看，猜测为同一类型的木马，发送的是博彩类型广告：</span>
</p>
<p style='text-align:center;color:#333333;font-family:-apple-system-font, BlinkMacSystemFont, "font-size:17px;'>
	<img class="rich_pages" src="../../../static/images/Upload/News/image/20190428/20190428153823_2456.png" style="height:auto !important;">
</p>
<p style='color:#333333;font-family:-apple-system-font, BlinkMacSystemFont, "font-size:17px;background:white;'>
	<span style="font-family:微软雅黑, sans-serif;font-size:16px;">除了在英雄联盟客户端内发送博彩广告外，病毒还会利用QQ的快速登录，盗取ClientKey值，然后在空间的说说中，加入定时说说，定时发送广告：</span>
</p>
<p style='text-align:center;color:#333333;font-family:-apple-system-font, BlinkMacSystemFont, "font-size:17px;'>
	<img class="rich_pages" src="../../../static/images/Upload/News/image/20190428/20190428153835_1587.png" style="height:auto !important;">
</p>
<p style='color:#333333;font-family:-apple-system-font, BlinkMacSystemFont, "font-size:17px;background:white;'>
	<span style="font-size:16px;"><strong><span style="font-family:微软雅黑, sans-serif;">木马二：</span></strong><strong><span style="font-family:微软雅黑, sans-serif;">棋牌游戏盗号木马</span></strong></span>
</p>
<p style='color:#333333;font-family:-apple-system-font, BlinkMacSystemFont, "font-size:17px;background:white;'>
	<span style="font-family:微软雅黑, sans-serif;font-size:16px;">这个就简单说一下，因为主要针对该棋牌游戏盗号木马插件主要针对以下4款游戏：</span>
</p>
<p style='text-align:center;color:#333333;font-family:-apple-system-font, BlinkMacSystemFont, "font-size:17px;'>
	<img class="rich_pages" src="../../../static/images/Upload/News/image/20190428/20190428153848_2671.png" style="height:auto !important;">
</p>
<p style='color:#333333;font-family:-apple-system-font, BlinkMacSystemFont, "font-size:17px;background:white;'>
	<span style="font-family:微软雅黑, sans-serif;font-size:16px;">木马通过检测以上4款游戏窗口找到游戏主进程，然后通过远程线程注入盗号DLL模块，挂钩指定函数，在用户进出游戏房间、存取游戏币、修改帐号密码等操作时拿到账户信息并上传。</span>
</p>
<p style='color:#333333;font-family:-apple-system-font, BlinkMacSystemFont, "font-size:17px;background:white;'>
	<span style="font-family:微软雅黑, sans-serif;font-size:16px;">盗号DLL模块在游戏进程加载后，会挂钩游戏相关的功能函数，拦截游戏内部消息。在用户进行登录、进入房间、存取钱、绑定解绑、修改密码等操作时，获取用户账户密码、银行密码、游戏币等数据，并加密上传至服务器。</span>
</p>
<p style='color:#333333;font-family:-apple-system-font, BlinkMacSystemFont, "font-size:17px;background:white;'>
	<span style="font-family:微软雅黑, sans-serif;font-size:16px;">其中针对登录游戏、进入房间、修改密码这3类操作会获取并上报用户的机器码Pr_MAC用于远程解绑洗号，当账号异地登录时会替换本地的提示消息，防止用户发现账号被盗（和上面英雄联盟的非法广告一样，玩家自己是看不到自己发送的博彩广告的。）：</span>
</p>
<p style='color:#333333;font-family:-apple-system-font, BlinkMacSystemFont, "font-size:17px;text-align:center;background:white;'>
	<span style="font-family:微软雅黑, sans-serif;color:windowtext;font-size:16px;"></span>
</p>
<p style='color:#333333;font-family:-apple-system-font, BlinkMacSystemFont, "font-size:17px;text-align:center;background:white;'>
	<span style="font-family:微软雅黑, sans-serif;color:windowtext;font-size:16px;"></span>
</p>
<p style='text-align:center;color:#333333;font-family:-apple-system-font, BlinkMacSystemFont, "font-size:17px;'>
	<img class="rich_pages" src="../../../static/images/Upload/News/image/20190428/20190428153954_0757.png" style="height:auto !important;">
</p>
<p style='text-align:center;color:#333333;font-family:-apple-system-font, BlinkMacSystemFont, "font-size:17px;'>
	<img class="rich_pages" src="../../../static/images/Upload/News/image/20190428/20190428154001_5308.png" style="height:auto !important;">
</p>
<p style='color:#333333;font-family:-apple-system-font, BlinkMacSystemFont, "font-size:17px;text-align:center;background:white;'>
	<span style="font-family:微软雅黑, sans-serif;font-size:16px;"> </span><span style="font-family:微软雅黑, sans-serif;font-size:16px;">那么，这种盗号方式有用吗？答案是肯定的，以下是病毒作者服务器上收集到的账号信息：</span>
</p>
<p style='text-align:center;color:#333333;font-family:-apple-system-font, BlinkMacSystemFont, "font-size:17px;'>
	<img class="rich_pages" src="../../../static/images/Upload/News/image/20190428/20190428154013_2573.png" style="height:auto !important;">
</p>
<p style='color:#333333;font-family:-apple-system-font, BlinkMacSystemFont, "font-size:17px;text-align:center;background:white;'>
	<span style="font-family:微软雅黑, sans-serif;color:windowtext;font-size:16px;"></span>
</p>
<p style='color:#333333;font-family:-apple-system-font, BlinkMacSystemFont, "font-size:17px;text-align:justify;'>
	<span style="font-size:16px;">以上就是英雄联盟非法博彩广告和棋牌盗号木马程序的所有运行原理。纹桃坚决反对任何非法博彩广告，对正规棋牌游戏的盗号产业也深恶痛绝。纹桃坚信只有绿色、健康的棋牌游戏才是行业的未来。</span><span style="background-color:#FFFFFF;font-size:16px;">纹桃科技致力于棋牌游戏开发15年，拥有大量</span><strong>棋牌游戏</strong><span style="background-color:#FFFFFF;font-size:16px;">成功案例。</span>
</p>
<p style='font-family:-apple-system-font, BlinkMacSystemFont, "text-indent:2em;'>
	<span style="font-size:16px;"><span style="line-height:32px;">   想开发一款迅速盈利的</span><strong><span style="line-height:32px;">棋牌游戏</span></strong><span style="line-height:32px;">，欢迎咨询热线电话：</span><span style="color:#E53333;">18711739336</span></span>
</p>
<p style='font-family:-apple-system-font, BlinkMacSystemFont, "text-indent:2em;'>
	<br>
</p>
<p style='text-align:center;color:#333333;font-family:-apple-system-font, BlinkMacSystemFont, "font-size:17px;text-indent:0em;'>
	<img class="rich_pages" src="../../../static/images/Upload/News/image/20190428/20190428154030_1040.png" style="height:262px;width:265px;">
</p>
<p style='text-align:center;font-family:-apple-system-font, BlinkMacSystemFont, "text-indent:0em;color:#222222;background-color:#FFFFFF;'>
	<span style="font-size:14px;color:#888888;">扫码二维码咨询更多棋牌游戏问题</span>
</p>
<div>
	<br>
</div>
</div>
</div>


    <div class="service">
        <div class="service_title">
            纹桃棋牌-专注棋牌开发十五年，我们能为您提供：
        </div>
        <ul>
            <li class="fn-clean-space">
                <em></em>
                <img src="/m/static/images/service_1.png">
                <div>
                    <p>游戏产品</p>
                    <p class="service_list_1">PRODUCTS</p>
                </div>
            </li>
            <li class="fn-clean-space">
                <em></em>
                <img src="/m/static/images/service_2.png">
                <div>
                    <p>售后服务</p>
                    <p class="service_list_2">SERVICE</p>
                </div>
            </li>
            <li class="fn-clean-space">
                <em></em>
                <img src="/m/static/images/service_3.png">
                <div>
                    <p>技术支持</p>
                    <p class="service_list_3">TECHNOLOGY</p>
                </div>
            </li>
            <li class="fn-clean-space">
                <em></em>
                <img src="/m/static/images/service_4.png">
                <div>
                    <p>运营指导</p>
                    <p class="service_list_4">OPERATING</p>
                </div>
            </li>
        </ul>
        <div class="service_title">
<a href="http://qr.ccm.gov.cn/lic/58BD9CBB1C934255A22FF3B36ECC9235" target="_blank">粤网文〔2019〕1102-277号</a>   <a href="http://www.beian.miit.gov.cn/" target="_blank">粤ICP备：11009383号-10</a>
</div>

    </div>
    <div class="bottom fn-clean-space">
        <em></em>
        <a target="_blank" href="mqqwpa://im/chat?chat_type=wpa&uin=2872536059&version=1&src_type=web&web_src=oicqzone.com"><img src="/m/static/images/bottom_1.png"></a>
        <a href="tel://18711739336"><img src="/m/static/images/bottom_2.png"></a>
    </div>
    <script src="/m/static/bundles/js.js"></script>

    
    <script type="text/javascript">
        var userAgent = navigator.userAgent.toLowerCase();
        var qqlink;
        $('.qq-link').on('click', function () {
            if (userAgent.indexOf('baidu') > 0 || userAgent.indexOf('ubrowser') > -1 || userAgent.indexOf('ucbrowser') > -1) {
                qqlink = "http://p.qiao.baidu.com/cps/chat?siteId=10112377&userId=3809269";
            } else {
                qqlink = $(this).attr('data-url');
            }
            location.href = qqlink;
        });
    </script>
    <!-- WPA Button Begin -->
    <!-- <script charset="utf-8" type="text/javascript" src="../../../https_wpa.b.qq.com/cgi/wpa.php%EF%BC%9Fkey=XzkzODAzNjgwOF80OTA3NjJfNDAwMDAwNzA0M18"></script> -->
    <!-- WPA Button End -->
</body>
</html>
